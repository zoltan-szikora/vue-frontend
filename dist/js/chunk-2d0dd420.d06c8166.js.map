{"version":3,"sources":["webpack:///./src/views/auth/UpdatePassword.vue","webpack:///./src/views/auth/UpdatePassword.vue?5edf"],"names":["class","role","for","icon","success","errorMessage","name","ref","submitUpdatedData","accept-charset","type","passwordValidity","currentPassword","placeholder","required","newPasswordValidity","newPassword","title","passwordPattern","pattern","confirmPasswordValidity","confirmPassword","submitted","disabled","loading","data","salt","genSaltSync","hash","computed","mapGetters","methods","mapActions","this","user","password","compareSync","hashSync","updatePassword","then","response","u","updateUser","$swal","showConfirmButton","timer","error","status","errors","defaultMessage","mounted","render"],"mappings":"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","file":"js/chunk-2d0dd420.d06c8166.js","sourcesContent":["<template>\r\n  <div class=\"container my-3 pb-5\">\r\n    <div class=\"pt-3\">\r\n      <h1 class=\"display-5 fw-bold\"><font-awesome-icon icon=\"user-shield\" class=\"me-1\" />Change password</h1>\r\n      <hr class=\"my-4\">\r\n    </div>\r\n    <div v-if=\"success\" class=\"alert alert-success rounded-0\">Your password successfully updated!</div>\r\n    <div v-if=\"errorMessage\" class=\"alert alert-danger rounded-0\" role=\"alert\">{{ errorMessage }}</div>\r\n\r\n    <div v-if=\"!success\" class=\"px-4\">\r\n      <h2 class=\"col-md-8 fs-4\">Change your password</h2>\r\n\r\n      <form name=\"update\" ref=\"form\" @submit.prevent=\"submitUpdatedData\" class=\"row g-3\" accept-charset=\"utf-8\">\r\n        <div class=\"mx-auto border form-bg px-5 py-3\">\r\n\r\n          <div class=\"mb-3\">\r\n            <label for=\"oldPassword\">Current Password</label>\r\n            <input type=\"password\" class=\"form-control\" :class=\"{ invalid: passwordValidity === 'invalid' }\" name=\"oldPassword\" v-model.trim=\"currentPassword\" placeholder=\"Current Password\" required>\r\n            <span class=\"invalid-feedback\">Password is required!</span>\r\n            <span class=\"err-msg\" v-if=\"passwordValidity == 'invalid'\">Your password is invalid!</span>\r\n          </div>\r\n\r\n          <div class=\"row\">\r\n            <div class=\"col-md-6 mb-3\">\r\n              <label for=\"password\">New password</label>\r\n              <input type=\"password\" class=\"form-control\" :class=\"{ invalid: newPasswordValidity === 'invalid' }\" name=\"password\" v-model.trim=\"newPassword\" placeholder=\"New password\"\r\n                :title=\"passwordPattern\" pattern=\"(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{6,20}\" required>\r\n              <span class=\"invalid-feedback\">New password is required!</span>\r\n              <span class=\"err-msg\" v-if=\"newPasswordValidity == 'invalid'\">Your new password cannot be same as old password!</span>\r\n            </div>\r\n            <div class=\"col-md-6 mb-3\">\r\n              <label for=\"confirmPassword\">Repeat new password</label>\r\n              <input type=\"password\" class=\"form-control\" :class=\"{ invalid: confirmPasswordValidity === 'invalid' }\" name=\"confirmPassword\" v-model.trim=\"confirmPassword\"\r\n                placeholder=\"Confirm password\" pattern=\"(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{6,20}\" required>\r\n              <span class=\"invalid-feedback\">Confirm password is required!</span>\r\n              <span class=\"err-msg\" v-if=\"confirmPasswordValidity == 'invalid'\">The password fields must match!</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"d-grid gap-2 col-4 mx-auto\">\r\n            <button class=\"btn btn-teal shadow-none my-3\" @click=\"submitted = true\" :disabled=\"loading\">Submit</button>\r\n          </div>\r\n\r\n        </div>\r\n      </form>\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport vuex from \"vuex\";\r\nimport UserService from \"@/services/user.service\";\r\nimport bcrypt from 'bcryptjs';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      salt: bcrypt.genSaltSync(10),\r\n      hash: \"\",\r\n      passwordValidity: \"pending\",\r\n      confirmPasswordValidity: \"pending\",\r\n      newPasswordValidity: \"pending\",\r\n      currentPassword: \"\",\r\n      newPassword: \"\",\r\n      confirmPassword: \"\",\r\n      loading: false,\r\n      success: false,\r\n      errorMessage: \"\",\r\n      passwordPattern: \"\"\r\n    }\r\n  },\r\n  computed: {\r\n    ...vuex.mapGetters([\"user\"])\r\n  },\r\n  methods: {\r\n    ...vuex.mapActions([\"updateUser\"]),\r\n    submitUpdatedData() {\r\n      this.loading = true;\r\n      if (\r\n        !this.currentPassword ||\r\n        !this.newPassword ||\r\n        !this.confirmPassword\r\n      )  return;\r\n\r\n      //if newPassword and confirmPassword not equals\r\n      if(this.newPassword != this.confirmPassword){\r\n        this.confirmPasswordValidity = \"invalid\";\r\n        this.loading = false;\r\n        return;\r\n      } else this.confirmPasswordValidity = \"valid\";\r\n\r\n      //currentPassword invalid\r\n      if (this.currentPassword == this.user.password || bcrypt.compareSync(this.currentPassword, this.user.password)) {\r\n        this.passwordValidity = \"valid\";\r\n      } else {\r\n        this.passwordValidity = \"invalid\";\r\n        this.currentPassword =\"\"\r\n        this.loading = false;\r\n        return;\r\n      }\r\n\r\n      //newPassword and currentPassword equals\r\n      if (this.currentPassword == this.newPassword) {\r\n        this.newPasswordValidity = \"invalid\";\r\n        this.loading = false;\r\n        return;\r\n      }\r\n\r\n      this.hash = bcrypt.hashSync(this.newPassword, this.salt);\r\n\r\n      UserService.updatePassword(this.user, this.currentPassword, this.hash)\r\n      .then(\r\n        (response) => {\r\n          response.data.password = this.newPassword;\r\n          const u = response.data;\r\n          this.updateUser(u);\r\n          this.success = true;\r\n          this.errorMessage = \"\";\r\n          this.$swal({\r\n            icon: 'success',\r\n            title:'Password Changed!',\r\n            showConfirmButton: false,\r\n            timer: 1500\r\n          });\r\n        },\r\n        error => {\r\n          if (!error.response) {\r\n            this.errorMessage =\r\n              \"Unexpected error: \" +\r\n              ((error && error.errorMessage) || error);\r\n          } else if (error.response.status === 401) {\r\n            this.errorMessage = \"Password is not valid!\";\r\n          } else if (error.response.status === 406) {\r\n            this.errorMessage = \"E-mail is already registered!\";\r\n          }\r\n          else {\r\n            this.errorMessage =\r\n              \"Error: \" + error.response.data.errors[0].defaultMessage;\r\n          }\r\n        }\r\n      )\r\n      .then(() => {\r\n        this.loading = false;\r\n      });\r\n\r\n    }\r\n  },\r\n  mounted () {\r\n    this.passwordPattern = process.env.VUE_APP_PASSWORD_PATTERN;\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n","import { render } from \"./UpdatePassword.vue?vue&type=template&id=0cb86328\"\nimport script from \"./UpdatePassword.vue?vue&type=script&lang=js\"\nexport * from \"./UpdatePassword.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}